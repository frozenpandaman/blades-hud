(this["webpackJsonpblades-hud"]=this["webpackJsonpblades-hud"]||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(43),l=n.n(r),s=n(15),o=n(8),i=n(9),u=n(6),d=n(11),p=n(10),m=n(13),f=(n(27),function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={email:"",pw:""},a.handleEmailChange=a.handleEmailChange.bind(Object(u.a)(a)),a.handlePwChange=a.handlePwChange.bind(Object(u.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(u.a)(a)),a}return Object(i.a)(n,[{key:"handleEmailChange",value:function(e){this.setState({email:e.target.value})}},{key:"handlePwChange",value:function(e){this.setState({pw:e.target.value})}},{key:"handleSubmit",value:function(e){m.auth().signInWithEmailAndPassword(this.state.email,this.state.pw).catch((function(e){console.log(e.message)})),e.preventDefault()}},{key:"render",value:function(){return a.createElement("form",{onSubmit:this.handleSubmit},a.createElement("label",null,"E-mail:",a.createElement("input",{type:"text",value:this.state.email,onChange:this.handleEmailChange}),"Password:",a.createElement("input",{type:"password",value:this.state.pw,onChange:this.handlePwChange})),a.createElement("input",{type:"submit",value:"Sign In"}))}}]),n}(a.PureComponent)),h=n(24),b=n(14);var v=n(19),k=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"is_full",value:function(e){return e.progress===e.n_slices}},{key:"is_empty",value:function(e){return 0===e.progress}},{key:"render",value:function(){var e=130,t=360/this.props.clock.n_slices,n=[];if(1===this.props.clock.n_slices)n.push(c.a.createElement(v.Circle,{x:65,y:65,radius:60,fill:1===this.props.clock.progress?"gray":"white",stroke:"black",strokeWidth:2,onClick:this.props.incr_func,onContextMenu:function(e){e.evt.preventDefault()}}));else for(var a=0;a<this.props.clock.n_slices;a++)n.push(c.a.createElement(v.Wedge,{x:65,y:65,radius:60,angle:t,fill:a<this.props.clock.progress?"gray":"white",stroke:"black",strokeWidth:2,rotation:a*t-90,onClick:this.props.incr_func,onContextMenu:function(e){e.evt.preventDefault()},key:a.toString()}));return c.a.createElement("div",{className:"flex flex-column mw5"},c.a.createElement("div",{className:"pa3 mw5 self-center"},c.a.createElement(v.Stage,{width:e,height:130},c.a.createElement(v.Layer,null,n))),c.a.createElement("p",{className:"tc pa1 ws-normal"},this.props.clock.desc))}}]),n}(c.a.PureComponent);var y=function(e){var t=Array.from(e.clocks).map((function(t){var n=t[0],a=t[1];return c.a.createElement("div",{key:n,className:"flex flex-column justify-between outline"},c.a.createElement("div",{className:""},c.a.createElement(k,{clock:a,incr_func:function(t){return e.click_func(t,e.owner,n)}})),c.a.createElement("div",{className:"tc pb2"},c.a.createElement("button",{className:"ba pointer ph1",onClick:function(){e.delete_func(n,e.owner)}},"Delete")))}));return c.a.createElement("div",null,c.a.createElement("div",{className:"p0"},c.a.createElement("p",{className:"ttc f3"},e.owner)),c.a.createElement("div",{className:"flex bt bb"},c.a.createElement("div",{className:"flex flex-column tc bg-blue pointer justify-center",onClick:function(){var t=window.prompt("What's the clock for?"),n=Number(window.prompt("How many slices?","4"));e.new_func(e.owner,t,n)}},c.a.createElement("div",{className:"f2 w3"},"+")),c.a.createElement("div",{className:"flex overflow-x-scroll items-top w-100"},t)))},_=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={group_clocks:new Map,world_event_clocks:new Map,player_clocks:{bricks:new Map,shivers:new Map,dogs:new Map,"tick tock":new Map},unsub_fns:[]},a.handle_clock_click=a.handle_clock_click.bind(Object(u.a)(a)),a.new_clock=a.new_clock.bind(Object(u.a)(a)),a.delete_clock=a.delete_clock.bind(Object(u.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentWillUnmount",value:function(){var e,t=Object(s.a)(this.state.unsub_fns);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}}},{key:"loadData",value:function(){for(var e=this,t=[],n=function(n){t[n]=e.props.db.collection(e.props.players[n]+"_clocks").orderBy("timestamp","desc").onSnapshot((function(t){var a=t.docs.map((function(e){return e.data()})),c=t.docs.map((function(e){return e.id})),r=new Map;c.forEach((function(e,t){r.set(e,a[t])})),"group"===e.props.players[n]?e.setState({group_clocks:r}):"world events"===e.props.players[n]?e.setState({world_event_clocks:r}):e.setState((function(t,a){return Object(b.a)({},t,{player_clocks:Object(b.a)({},t.player_clocks,Object(h.a)({},e.props.players[n],r))})}))})),e.setState((function(e,n){return Object(b.a)({},e,{unsub_fns:e.unsub_fns.concat(t)})}))},a=0;a<this.props.players.length;a++)n(a)}},{key:"new_clock",value:function(e,t,n){this.props.db.collection(e+"_clocks").add({desc:t,n_slices:n,progress:0,timestamp:m.firestore.Timestamp.now()})}},{key:"incr_clock",value:function(e,t){return 1===t&&e.n_slices===e.progress||-1===t&&0===e.progress?e:Object(b.a)({},e,{progress:e.progress+t,n_slices:e.n_slices})}},{key:"handle_clock_click",value:function(e,t,n){var a=this;null===this.props.user&&alert("Error: You're not logged in! AaaAAh!");var c=e.evt;if(c.preventDefault(),0===c.button||2===c.button){var r=0===c.button?1:-1,l=this.props.db.collection(t+"_clocks").doc(n);l.get().then((function(e){var t=e.data();l.set(a.incr_clock(t,r))}))}}},{key:"delete_clock",value:function(e,t){this.props.db.collection(t+"_clocks").doc(e).delete()}},{key:"render",value:function(){var e=this,t=["world events","group"].concat(function(e,t){var n=e.indexOf(t),a=e.slice(0);return a.splice(n,1),a.splice(0,0,t),a}(this.props.players.slice(2),this.props.current_player)),n=function(t){return"group"===t?e.state.group_clocks:"world events"===t?e.state.world_event_clocks:e.state.player_clocks[t]};return c.a.createElement("div",null,t.map((function(t){return c.a.createElement("div",{key:t,className:""},c.a.createElement(y,{owner:t,clocks:n(t),click_func:e.handle_clock_click,new_func:e.new_clock,delete_func:e.delete_clock}))})))}}]),n}(c.a.PureComponent),w=n(44),g=n.n(w),E=n(45),j=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).element=c.a.createRef(),a.state={landmarks:new Map,unsub_fns:[],open_id:"",img_height:0,img_width:0},a.handleMapClick=a.handleMapClick.bind(Object(u.a)(a)),a.newLandmark=a.newLandmark.bind(Object(u.a)(a)),a.deleteLandmark=a.deleteLandmark.bind(Object(u.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.loadData(),this.updateDimensions(),window.addEventListener("resize",this.updateDimensions.bind(this))}},{key:"componentWillUnmount",value:function(){var e,t=Object(s.a)(this.state.unsub_fns);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}window.removeEventListener("resize",this.updateDimensions.bind(this))}},{key:"updateDimensions",value:function(){var e=this.element.current;this.setState({img_height:e.clientHeight,img_width:e.clientWidth})}},{key:"loadData",value:function(){var e=this,t=this.props.db.collection("landmarks").orderBy("timestamp","desc").onSnapshot((function(t){var n=t.docs.map((function(e){return e.data()})),a=t.docs.map((function(e){return e.id})),c=new Map;a.forEach((function(e,t){c.set(e,n[t])})),e.setState({landmarks:c},(function(){return console.log(e.state.landmarks)}))}));this.setState((function(e,n){return Object(b.a)({},e,{unsub_fns:e.unsub_fns.concat(t)})}))}},{key:"handleMapClick",value:function(e){var t=e.target.getBoundingClientRect(),n=(e.clientX-t.left)/e.target.offsetWidth,a=(e.clientY-e.target.offsetTop)/e.target.offsetHeight;console.log(e.target.offsetTop),this.newLandmark(n,a)}},{key:"newLandmark",value:function(e,t){this.props.db.collection("landmarks").add({x:e,y:t,desc:"",title:"",timestamp:m.firestore.Timestamp.now()})}},{key:"deleteLandmark",value:function(e){this.props.db.collection("landmarks").doc(e).delete()}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement("img",{ref:this.element,className:"w-100",src:g.a,onClick:function(t){return e.handleMapClick(t)}}),Array.from(this.state.landmarks).map((function(t){var n=t[0],a=t[1];return c.a.createElement(E.a,{onClick:function(){return e.deleteLandmark(n)},style:{filter:"text-shadow(-1px 0 #000, 0 1px #000, 1px 0 #000, 0 -1px #000)",color:"red",position:"absolute",left:e.state.img_width*a.x,top:e.state.img_height*a.y}})})))}}]),n}(c.a.PureComponent),O=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={notes:new Map,unsub_fns:[]},a.save_note=a.save_note.bind(Object(u.a)(a)),a.new_note=a.new_note.bind(Object(u.a)(a)),a.delete_note=a.delete_note.bind(Object(u.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentWillUnmount",value:function(){var e,t=Object(s.a)(this.state.unsub_fns);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}}},{key:"loadData",value:function(){var e=this,t=this.props.db.collection("notes").orderBy("timestamp","desc").onSnapshot((function(t){var n=t.docs.map((function(e){return e.data()})),a=t.docs.map((function(e){return e.id})),c=new Map;a.forEach((function(e,t){c.set(e,n[t])})),e.setState({notes:c})}));this.setState((function(e,n){return Object(b.a)({},e,{unsub_fns:e.unsub_fns.concat(t)})}))}},{key:"new_note",value:function(e,t,n){this.props.db.collection("notes").add({name:e,desc:t,type:n,timestamp:m.firestore.Timestamp.now()})}},{key:"save_note",value:function(e,t,n,a){this.props.db.collection("notes").doc(e).set({name:t,desc:n,type:a,timestamp:m.firestore.Timestamp.now()})}},{key:"delete_note",value:function(e){this.props.db.collection("notes").doc(e).delete()}},{key:"render",value:function(){return c.a.createElement("div",null,Array.from(this.state.notes).map((function(e){var t=e[0],n=e[1];return c.a.createElement("div",{key:t,className:""},c.a.createElement("h1",null,n.name),c.a.createElement("h2",null,n.type),c.a.createElement("p",null,n.desc))})))}}]),n}(c.a.PureComponent),C=["Clocks","Map","Notes"],x=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={current_page:C[0]},a}return Object(i.a)(n,[{key:"render",value:function(){var e=this;return a.createElement("div",{className:"pa1 w-100 vh-100 overflow-y-scroll"},a.createElement("div",{className:"flex flex-wrap",style:{justifyContent:"space-around"}},C.map((function(t){return a.createElement("button",{className:"bg-blue f3 flex-auto pointer tc br",onClick:function(){return e.setState({current_page:t})}},t)}))),a.createElement("hr",null),a.createElement("div",{style:{display:"Clocks"===this.state.current_page?"initial":"none"}},a.createElement(_,this.props)),a.createElement("div",{style:{display:"Map"===this.state.current_page?"initial":"none"}},a.createElement(j,this.props)),a.createElement("div",{style:{display:"Notes"===this.state.current_page?"initial":"none"}},a.createElement(O,this.props)))}}]),n}(a.PureComponent),N=n(46),S=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={dice:[1]},a}return Object(i.a)(n,[{key:"new_die",value:function(){this.setState((function(e){return{dice:[].concat(Object(N.a)(e.dice),[1])}}))}},{key:"delete_die",value:function(){this.setState((function(e){return{dice:e.dice.slice(0,-1)}}))}},{key:"handle_die_click",value:function(e){this.setState((function(t){return{dice:t.dice.map((function(t,n){return n===e?(a=6,Math.floor(Math.random()*Math.floor(a))+1):t;var a}))}}))}},{key:"render",value:function(){var e=this,t=this.state.dice.map((function(t,n){return c.a.createElement("div",{className:"w3 h3 ba br2 pointer bg-yellow tc flex flex-column justify-center ma2",onClick:function(){return e.handle_die_click(n)}},c.a.createElement("div",{className:"f2"},t))}));return c.a.createElement("div",null,c.a.createElement("h3",{className:"tc"},"Here roll some dice why not?"),c.a.createElement("div",{className:"flex",style:{justifyContent:"space-around"}},c.a.createElement("button",{className:"bg-blue f2 flex-auto pointer tc br",onClick:function(){return e.delete_die()}},"-"),c.a.createElement("button",{className:"bg-blue f2 flex-auto pointer tc",onClick:function(){return e.new_die()}},"+")),c.a.createElement("div",{className:"flex flex-wrap justify-around"},t),c.a.createElement("div",{className:"flex",style:{justifyContent:"space-around"}},c.a.createElement("button",{className:"bg-blue f2 flex-auto pointer tc br",onClick:function(){e.state.dice.map((function(t,n){return e.handle_die_click(n)}))}},"Roll All")))}}]),n}(c.a.PureComponent),M=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={notes:""},a}return Object(i.a)(n,[{key:"render",value:function(){return c.a.createElement("div",{className:"flex"},c.a.createElement("textarea",{className:"flex-auto",rows:30},"This doesn't actually save, so, ya know, don't really use it yet."))}}]),n}(c.a.PureComponent),D=["dice"],P=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={current_tool:D[0]},a.renderSwitch=a.renderSwitch.bind(Object(u.a)(a)),a}return Object(i.a)(n,[{key:"renderSwitch",value:function(e){switch(e){case"dice":return a.createElement(S,null);case"notes":return a.createElement(M,null);default:return null}}},{key:"render",value:function(){return a.createElement("div",{className:"pa1"},a.createElement(S,null))}}]),n}(a.PureComponent),W=(n(102),["group","world events","bricks","shivers","dogs","tick tock"]),A=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(e){var a;Object(o.a)(this,n),a=t.call(this,e);var c=m.auth().onAuthStateChanged((function(e){a.setState({user:e})}));return a.state={user:null,current_player:"bricks",unsub_fns:[c],db:m.firestore()},a.change_player=a.change_player.bind(Object(u.a)(a)),a}return Object(i.a)(n,[{key:"componentWillUnmount",value:function(){var e,t=Object(s.a)(this.state.unsub_fns);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(n){t.e(n)}finally{t.f()}}},{key:"change_player",value:function(e){this.setState({current_player:e.currentTarget.value})}},{key:"render",value:function(){return this.state.user?c.a.createElement("div",{className:"flex"},c.a.createElement("div",{className:"flex flex-column w-80"},c.a.createElement(x,Object.assign({players:W},this.state))),c.a.createElement("div",{className:"flex-column w-20 outline"},c.a.createElement("div",{className:"flex flex-wrap"},c.a.createElement("p",{className:"f4"},"Which one are you?"),c.a.createElement("select",{value:this.state.current_player,onChange:this.change_player},W.slice(2).map((function(e){return c.a.createElement("option",{value:e},e)})))),c.a.createElement(P,null))):c.a.createElement("div",{className:"outline"},c.a.createElement(f,null))}}]),n}(c.a.PureComponent);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));m.initializeApp({apiKey:"AIzaSyAwY_9bJhDtZRn52OWKkU9J3gNklyB2MaU",authDomain:"bitd-hud.firebaseapp.com",databaseURL:"https://bitd-hud.firebaseio.com",projectId:"bitd-hud",storageBucket:"bitd-hud.appspot.com",messagingSenderId:"87588692405",appId:"1:87588692405:web:eb12f6f11340afbc"}),l.a.render(c.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},44:function(e,t,n){e.exports=n.p+"static/media/bitd_s3_map.3671edd5.png"},47:function(e,t,n){e.exports=n(105)}},[[47,1,2]]]);
//# sourceMappingURL=main.76072b1d.chunk.js.map